<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ–‡å–®å­—åœˆåœˆå‰å‰ - é‹å‹•èˆ‡å¥åº·ç¯‡</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --bg-color: #f0f2f5;
            --cell-bg: #ffffff;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 2rem;
            text-align: center;
        }

        .status {
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: bold;
            color: var(--accent-color);
        }

        /* æ£‹ç›¤è¨­å®š */
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            background-color: #bdc3c7;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .cell {
            background-color: var(--cell-bg);
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.9rem;
            padding: 5px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
            flex-direction: column;
        }

        .cell:hover {
            background-color: #e8f6f3;
        }

        .cell.taken {
            cursor: default;
            background-color: #fff;
        }

        .cell .hint {
            pointer-events: none;
            color: #555;
            font-weight: 500;
        }

        .cell .mark {
            font-size: 3rem;
            font-weight: bold;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .mark.x { color: #e74c3c; opacity: 0.8; }
        .mark.o { color: #2ecc71; opacity: 0.8; }

        /* é‡æ–°é–‹å§‹æŒ‰éˆ• */
        .restart-btn {
            margin-top: 25px;
            padding: 10px 25px;
            font-size: 1rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .restart-btn:hover {
            background-color: #34495e;
        }

        /* ç­”é¡Œè¦–çª— (Modal) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 400px;
        }

        .modal-question {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .modal-input {
            width: 80%;
            padding: 10px;
            font-size: 1.1rem;
            margin-bottom: 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
        }

        .modal-btn {
            padding: 10px 20px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .modal-close {
            margin-top: 10px;
            background-color: #95a5a6;
        }

        @media (max-width: 500px) {
            .cell {
                width: 90px;
                height: 90px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>

    <h1>å–®å­—åœˆåœˆå‰å‰ (Tic-Tac-Toe)</h1>
    <div class="status" id="status">ç©å®¶ X çš„å›åˆ</div>

    <div class="board" id="board">
        </div>

    <button class="restart-btn" onclick="initGame()">é‡æ–°é–‹å§‹éŠæˆ²</button>

    <div class="modal-overlay" id="modal">
        <div class="modal-box">
            <h3 id="modalTitle">è«‹ç¿»è­¯é€™å€‹å–®å­—ï¼š</h3>
            <p class="modal-question" id="modalQuestion">--</p>
            <input type="text" class="modal-input" id="answerInput" placeholder="è¼¸å…¥è‹±æ–‡å–®å­—" autocomplete="off">
            <br>
            <button class="modal-btn" onclick="checkAnswer()">é€å‡ºç­”æ¡ˆ</button>
            <button class="modal-btn modal-close" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>

<script>
    // ==========================================
    // 1. è³‡æ–™åº«å€ï¼šå¯åœ¨æ­¤æ›¿æ›æˆ–æ–°å¢å–®å­—
    // ==========================================
    const wordBank = [
        { word: "athlete", hint: "n. [U] é‹å‹•å“¡" },
        { word: "athletic", hint: "adj. é‹å‹•çš„" },
        { word: "muscle", hint: "n. [U] è‚Œè‚‰" },
        { word: "workout", hint: "n. [C] é‹å‹•ï¼Œè¨“ç·´" },
        { word: "routine", hint: "n. [C] ä¾‹è¡Œå…¬äº‹ï¼Œæ…£ä¾‹" },
        { word: "peak", hint: "adj. æœ€ä½³çš„ï¼Œå·”å³°çš„" },
        { word: "peak", hint: "n. [C] å·”å³°" },
        { word: "peak", hint: "vi. é”åˆ°æœ€é«˜é»" },
        { word: "recovery", hint: "n. [U] (èº«é«”å¥åº·) æ¢å¾©ï¼Œç—Šç™’" },
        { word: "recover", hint: "vi. æ¢å¾©ï¼Œå¾©åŸ" },
        { word: "injury", hint: "n. [C] å‚·å®³ï¼Œå—å‚·" },
        { word: "injure", hint: "vt. å‚·å®³ï¼Œä½¿å—å‚·" },
        { word: "stiff", hint: "adj. (èº«é«”éƒ¨ä½) åƒµç¡¬çš„" },
        { word: "stiff", hint: "adj. å …ç¡¬çš„" },
        { word: "Western", hint: "adj. è¥¿æ–¹åœ‹å®¶çš„" },
        { word: "western", hint: "adj. è¥¿éƒ¨çš„" },
        { word: "bandage", hint: "n. [C] ç¹ƒå¸¶" },
        { word: "bandage", hint: "vt. ç”¨ç¹ƒå¸¶åŒ…ç´®" },
        { word: "swelling", hint: "n. [U] è…«è„¹ï¼Œè…«å¡Š" },
        { word: "swell", hint: "vi. è…«è„¹" },
        { word: "insert", hint: "vt. æ’å…¥ï¼Œæ”¾é€²" },
        { word: "needle", hint: "n. [C] (é†«ç™‚/ç¸«ç´‰) é‡" },
        { word: "suck", hint: "vt. æŠ½å‡º (æ°£ã€æ¶²é«”)" },
        { word: "suck", hint: "vi. å¸" },
        { word: "smooth", hint: "adj. é †åˆ©çš„ï¼Œæµæš¢çš„" },
        { word: "smooth", hint: "adj. å¹³æ»‘çš„ï¼Œå…‰æ»‘çš„" },
        { word: "smooth", hint: "vt. æ’«å¹³ï¼Œä½¿å¹³æ•´" },
        { word: "doubt", hint: "n. [U] ç–‘æ…®ï¼Œæ‡·ç–‘" },
        { word: "doubt", hint: "vt. æ‡·ç–‘ï¼Œä¸ç¢ºå®š" },
        { word: "doubtful", hint: "adj. æ‡·ç–‘çš„ï¼Œæœ‰ç–‘æ…®çš„" },
        { word: "circulation", hint: "n. [U] (è¡€æ¶²) å¾ªç’°" },
        { word: "circulate", hint: "vi. å¾ªç’°ï¼Œæµå‹•" },
        { word: "circular", hint: "adj. åœ“å½¢çš„ï¼Œç’°å½¢çš„" },
        { word: "reveal", hint: "vt. å±•ç¾ / æ­éœ²" },
        { word: "perform", hint: "vt. åŸ·è¡Œ / è¡¨æ¼”" },
        { word: "performance", hint: "n. [C] è¡¨æ¼”ï¼Œæ¼”å‡º" },
        { word: "stimulate", hint: "vt. ä¿ƒé€²ï¼Œæ¿€ç™¼" },
        { word: "relieve", hint: "vt. ç´“è§£ï¼Œè§£é™¤" },
        { word: "relief", hint: "n. [U] å¯¬æ…°ï¼Œæ”¾å¿ƒ" },
        { word: "competition", hint: "n. [U] ç«¶çˆ­" },
        { word: "compete", hint: "vi. ç«¶çˆ­ï¼Œå°æŠ—" },
        { word: "competitive", hint: "adj. ç«¶çˆ­çš„ï¼Œç«¶è³½çš„" },
        { word: "shorten", hint: "vt. ç¸®çŸ­ï¼Œè®ŠçŸ­" },
        { word: "speed up something", hint: "phr. ä½¿â€¦åŠ é€Ÿ (å«å—è©)" },
        { word: "stem from something", hint: "phr. ç”±â€¦é€ æˆ (å«å—è©)" },
        { word: "result in", hint: "phr. å°è‡´â€¦ç™¼ç”Ÿ" },
        { word: "engage in something", hint: "phr. åƒèˆ‡â€¦ (å«å—è©)" },
        { word: "turn to", hint: "phr. æ±‚åŠ©æ–¼â€¦" },
        { word: "at home", hint: "phr. åœ¨å®¶è£¡" },
        { word: "make the headlines", hint: "phr. æˆç‚ºé ­æ¢ (make ...)" },
        { word: "grab the headlines", hint: "phr. æˆç‚ºé ­æ¢ (grab ...)" },
        { word: "hit the headlines", hint: "phr. æˆç‚ºé ­æ¢ (hit ...)" }
    ];

    // ==========================================
    // 2. éŠæˆ²è®Šæ•¸èˆ‡é‚è¼¯
    // ==========================================
    let boardState = ["", "", "", "", "", "", "", "", ""];
    let currentWords = []; // å­˜æ”¾ç•¶å‰ç›¤é¢çš„9å€‹å–®å­—ç‰©ä»¶
    let currentPlayer = "X";
    let gameActive = true;
    let selectedCellIndex = null;

    const statusDisplay = document.getElementById('status');
    const boardElement = document.getElementById('board');
    const modal = document.getElementById('modal');
    const modalQuestion = document.getElementById('modalQuestion');
    const answerInput = document.getElementById('answerInput');

    const winningConditions = [
        [0, 1, 2], [3, 4, 5], [6, 7, 8], // æ©«å‘
        [0, 3, 6], [1, 4, 7], [2, 5, 8], // ç›´å‘
        [0, 4, 8], [2, 4, 6]             // æ–œå‘
    ];

    // æ´—ç‰Œå‡½æ•¸ (Fisher-Yates Shuffle)
    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [
                array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    // åˆå§‹åŒ–éŠæˆ²
    function initGame() {
        boardState = ["", "", "", "", "", "", "", "", ""];
        gameActive = true;
        currentPlayer = "X";
        statusDisplay.innerText = `ç©å®¶ ${currentPlayer} çš„å›åˆ`;
        
        // å¾é¡Œåº«éš¨æ©Ÿé¸9å€‹å­—
        const shuffledBank = shuffle([...wordBank]); // è¤‡è£½ä¸¦æ´—ç‰Œ
        currentWords = shuffledBank.slice(0, 9);

        renderBoard();
        closeModal();
    }

    // æ¸²æŸ“æ£‹ç›¤
    function renderBoard() {
        boardElement.innerHTML = "";
        boardState.forEach((cell, index) => {
            const cellElement = document.createElement('div');
            cellElement.classList.add('cell');
            
            if (cell !== "") {
                cellElement.classList.add('taken');
                // é¡¯ç¤º O æˆ– X
                const mark = document.createElement('span');
                mark.classList.add('mark', cell.toLowerCase());
                mark.innerText = cell;
                cellElement.appendChild(mark);
            } else {
                // é¡¯ç¤ºä¸­æ–‡æç¤º
                const hint = document.createElement('div');
                hint.classList.add('hint');
                hint.innerText = currentWords[index].hint;
                cellElement.appendChild(hint);
                
                // ç¶å®šé»æ“Šäº‹ä»¶
                cellElement.addEventListener('click', () => handleCellClick(index));
            }
            boardElement.appendChild(cellElement);
        });
    }

    // è™•ç†æ ¼å­é»æ“Š
    function handleCellClick(index) {
        if (!gameActive || boardState[index] !== "") return;
        
        selectedCellIndex = index;
        openModal(currentWords[index].hint);
    }

    // é–‹å•Ÿç­”é¡Œè¦–çª—
    function openModal(questionText) {
        modal.style.display = 'flex';
        modalQuestion.innerText = questionText;
        answerInput.value = "";
        answerInput.focus();
    }

    // é—œé–‰ç­”é¡Œè¦–çª—
    function closeModal() {
        modal.style.display = 'none';
        selectedCellIndex = null;
    }

    // æª¢æŸ¥ç­”æ¡ˆ
    function checkAnswer() {
        if (selectedCellIndex === null) return;

        const userAnswer = answerInput.value.trim().toLowerCase();
        const correctAnswer = currentWords[selectedCellIndex].word.toLowerCase();

        // å¯¬é¬†åˆ¤å®šï¼šå¦‚æœæ­£ç¢ºç­”æ¡ˆåŒ…å« user è¼¸å…¥çš„å…§å®¹ (é‡å°ç‰‡èªçš„ç‰¹æ®Šç‹€æ³)
        // åš´æ ¼åˆ¤å®šï¼šå®Œå…¨ç›¸ç­‰
        if (userAnswer === correctAnswer) {
            // ç­”å°
            boardState[selectedCellIndex] = currentPlayer;
            renderBoard();
            checkResult();
            if (gameActive) {
                switchPlayer();
            }
            closeModal();
        } else {
            // ç­”éŒ¯
            alert(`ç­”éŒ¯äº†ï¼\næ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${currentWords[selectedCellIndex].word}\nè«‹å†è©¦ä¸€æ¬¡æˆ–æ›äººä½œç­”ã€‚`);
            // é€™è£¡é¸æ“‡ä¸é—œé–‰è¦–çª—ï¼Œè®“å­¸ç”Ÿå¯ä»¥é‡è©¦ã€‚
            // è‹¥è¦åš´æ ¼æ¨¡å¼ (ç­”éŒ¯æ›äºº)ï¼Œå¯è¨»è§£æ‰ä¸Šä¸€è¡Œä¸¦åŸ·è¡Œ switchPlayer() + closeModal();
            answerInput.value = "";
            answerInput.focus();
        }
    }

    // æ”¯æ´ Enter éµé€å‡º
    answerInput.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            checkAnswer();
        }
    });

    // åˆ‡æ›ç©å®¶
    function switchPlayer() {
        currentPlayer = currentPlayer === "X" ? "O" : "X";
        statusDisplay.innerText = `ç©å®¶ ${currentPlayer} çš„å›åˆ`;
        statusDisplay.style.color = currentPlayer === "X" ? "#e74c3c" : "#2ecc71";
    }

    // åˆ¤å®šå‹è² 
    function checkResult() {
        let roundWon = false;
        for (let i = 0; i < winningConditions.length; i++) {
            const [a, b, c] = winningConditions[i];
            if (boardState[a] === "" || boardState[b] === "" || boardState[c] === "") {
                continue;
            }
            if (boardState[a] === boardState[b] && boardState[b] === boardState[c]) {
                roundWon = true;
                break;
            }
        }

        if (roundWon) {
            statusDisplay.innerText = `ğŸ‰ æ­å–œï¼ç©å®¶ ${currentPlayer} ç²å‹ï¼`;
            gameActive = false;
            return;
        }

        if (!boardState.includes("")) {
            statusDisplay.innerText = "ğŸ¤ å¹³æ‰‹ï¼";
            gameActive = false;
            return;
        }
    }

    // å•Ÿå‹•éŠæˆ²
    initGame();

</script>

</body>
</html>